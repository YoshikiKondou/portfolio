<div class="container-fluid p-lg-5 bg-light  mb-5">
  <div class="col-sm">
    <h2 class="mb-5">トレーニング一覧</h2>
  </div>
  <% if flash[:success] %>
    <p class="success alert alert-success" role="alert"><%= flash[:success] %></p>
  <% elsif flash[:failure] %>
    <p class="failure alert alert-danger" role="alert"><%= flash[:failure] %></p>
  <% end %>
  <div class="row feature-wrapper">
    <div class="col-sm-3 feature">
      <div class="form-group pt-5">
        <%= form_with model: @workout, method: :get, local: :true do |f| %>
          <div class="form-row mb-2">
            <div class="col-md-9">
              <%= f.select :search, ["胸", "腕", "背中", "脚", "四頭", "ハム、尻部", "腹筋"], {include_blank: "部位を選択"}, {class: "form-control mb-3 mt-3", required: true } %>
              <%= f.submit '部位で絞り込む', name: "commit", class: "btn btn-primary btn-block mb-1 mt-3 bg-danger" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="col-sm-5">
      <div class="form-group mb-1">
        <div class="box1">
          <span class="box-title">MAX重量早見表(画像をクリック)</span>
          <div class="course-item">
            <%= image_tag "picture.jpg", height: '150', :style=>"width:200;", class: "course-item-img" %>
          </div>
          <div id="grayDisplay"></div>
        </div>
      </div>
    </div>
  </div>

  <table class="table table-bordered text-nowrap table-bordered table-hover mt-3">
    <thead>
      <tr>
        <th class="text-center" scope="col">日付</th>
        <th class="text-center" scope="col">体重</th>
        <th class="text-center" scope="col">部位</th>
        <th class="text-center" scope="col">トレーニング内容</th>
        <th class="text-center" scope="col">1set</th>
        <th class="text-center" scope="col">2set</th>
        <th class="text-center" scope="col">3set</th>
        <th class="text-center" scope="col">4set</th>
        <th class="text-center" scope="col">5set</th>
        <th class="text-center" scope="col">睡眠</th>
        <th class="text-center" scope="col">食事</th>
        <th class="text-center" scope="col">やる気</th>
        <th class="text-center" scope="col">疲労度</th>
        <th class="text-center" scope="col">筋肉の状態</th>
    </thead>
    <tbody>
      <% if @workouts.count > 0 %>
        <% @workouts.each do |workout| %>
          <tr class="align-middle lh-2">
            <td>
              <div class="text-center">
                <%= workout.start_time.strftime("%m月%-d日") %> 
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= workout.body_weight %>kg
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= workout.part %>
              </div>
            </td>
            <td class="text-left">
              <% workout.workout_menus.each do |workout_menu| %>
                <%= workout_menu.menu %>
                <br>
              <% end %>
            </td>
            <td>
              <% workout.workout_menus.each do |workout_menu| %>
                <div class="text-center">
                  <%= workout_menu.first_set_weight %>×<%= workout_menu.first_set_rep %> 
                  <br>
                </div>
              <% end %>
            </td>
            <td>
              <% workout.workout_menus.each do |workout_menu| %>
                <% if workout_menu.second_set_weight? %>
                  <div class="text-center">
                    <%= workout_menu.second_set_weight %>×<%= workout_menu.second_set_rep %> 
                    <br>
                  </div>
                <% end %>
              <% end %>
            </td>
            <td>
              <% workout.workout_menus.each do |workout_menu| %>
                <% if workout_menu.third_set_weight? %>
                  <div class="text-center">
                    <%= workout_menu.third_set_weight %>×<%= workout_menu.third_set_rep %> 
                    <br>
                  </div>
                <% end %>
              <% end %>
            </td>
            <td>
              <% workout.workout_menus.each do |workout_menu| %>
                <% if workout_menu.fourth_set_weight? %>
                  <div class="text-center">
                    <%= workout_menu.fourth_set_weight %>×<%= workout_menu.fourth_set_rep %> 
                    <br>
                  </div>
                  <br>
                <% end %>
              <% end %>
            </td>
            <td>
              <% workout.workout_menus.each do |workout_menu| %>
                <% if workout_menu.fifth_set_weight? %>
                  <div class="text-center">
                    <%= workout_menu.fifth_set_weight %>×<%= workout_menu.fifth_set_rep %>
                    <br>
                  </div>
                  <br>
                <% end %>
              <% end %>
            </td>
            <td>
              <div class="text-center">
                <%= workout.sleep %> 
              </div>           
            </td>
            <td>
              <div class="text-center">
                <%= workout.eat %> 
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= workout.motivation %> 
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= workout.fatigue %> 
              </div> 
            </td>
            <td>
              <div class="text-center">
                <%= workout.muscle %> 
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= link_to "確認", workout_path(workout) %>
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= link_to "編集", edit_workout_path(workout) %>
              </div>
            </td>
            <td>
              <div class="text-center">
                <%= link_to "削除", workout_path(workout), data: {turbo_method: :delete, turbo_confirm: "本当に削除しますか？"} %>
              </div>
            </td>
          </tr>
        <% end %>
      <% else %>
        <td>現在トレーニング履歴はありません</td>
      <% end %>
    </tbody>
  </table>

  <div class="workout new">
    <% if @workouts.count > 0 %>
      <% @workouts.each do |workout| %>
        <div class="field form-row">
          <th>日付:</th>
            <%= workout.start_time.strftime("%F") %>
        </div>
        <div class="field form-row">
          <th>体重:</th>
          <%= workout.body_weight %>kg
        </div>
        <div class="field form-row">
          <th>部位:</th>
          <%= workout.part %>
        </div>
        <% workout.workout_menus.each do |workout_menu| %>
          <div class="field form-row">
            <th>種目:</th>
              <%= workout_menu.menu %>
          </div>
          <div class="field form-row">
              <th>1st set:</th>
                <%= workout_menu.first_set_weight %> kg×<%= workout_menu.first_set_rep %> 回
            </div>
            <% if workout_menu.second_set_weight? %>
              <div class="field form-row">
              <th>2nd set:</th>
              <%= workout_menu.second_set_weight %> kg×<%= workout_menu.second_set_rep %> 回
            </div>
          <% end %>
          <% if workout_menu.third_set_weight? %>
            <div class="field form-row">
              <th>3d set:</th>
              <%= workout_menu.third_set_weight %> kg×<%= workout_menu.third_set_rep %> 回
            </div>
          <% end %>
          <% if workout_menu.fourth_set_weight? %>
            <div class="field form-row">
              <th>4th set:</th>
              <%= workout_menu.fourth_set_weight %> kg×<%= workout_menu.fourth_set_rep %> 回
            </div>
          <% end %>
          <% if workout_menu.fifth_set_weight? %>
            <div class="field form-row">
              <th>5th set:</th>
              <%= workout_menu.fifth_set_weight %> kg×<%= workout_menu.fifth_set_rep %> 回
            </div>
          <% end %>
        <% end %>
        <div class="field form-row">
          <th>睡眠:</th>
          <%= workout.sleep %>
        </div>
        <div class="field form-row">
          <th>食事:</th>
          <%= workout.eat %>
        </div>
        <div class="field form-row">
          <th>モチベーション:</th>
          <%= workout.motivation %>
        </div>
        <div class="field form-row">
          <th>疲労度:</th>
          <%= workout.fatigue %>
        </div>
        <div class="field form-row">
          <th>筋肉の状態:</th>
          <%= workout.muscle %>
        </div>
        <button>
          <%= link_to "確認", workout_path(workout) %>
        </button>
        <button>
          <%= link_to "編集", edit_workout_path(workout) %>
        </button>
        <button>
          <%= link_to "削除", workout_path(workout), data: {turbo_method: :delete, turbo_confirm: "本当に削除しますか？"} %> 
        </button>
      <% end %>
    <% else %>
      <td>現在トレーニング履歴はありません</td>
    <% end %>
  </div>
</div>
